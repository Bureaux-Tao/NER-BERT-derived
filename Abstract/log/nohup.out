ssh://bureaux@172.30.2.148:22/home/bureaux/miniconda3/envs/Keras-base/bin/python -u /home/bureaux/Projects/keras4bert/Abstract/train.py
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:516: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:517: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:518: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:519: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:520: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/framework/dtypes.py:525: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:541: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint8 = np.dtype([("qint8", np.int8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:542: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint8 = np.dtype([("quint8", np.uint8, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:543: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint16 = np.dtype([("qint16", np.int16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:544: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_quint16 = np.dtype([("quint16", np.uint16, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:545: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  _np_qint32 = np.dtype([("qint32", np.int32, 1)])
/home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorboard/compat/tensorflow_stub/dtypes.py:550: FutureWarning: Passing (type, 1) or '1type' as a synonym of type is deprecated; in a future version of numpy, it will be understood as (type, (1,)) / '(1,)type'.
  np_resource = np.dtype([("resource", np.ubyte, 1)])
Using TensorFlow backend.
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:517: The name tf.placeholder is deprecated. Please use tf.compat.v1.placeholder instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:4185: The name tf.truncated_normal is deprecated. Please use tf.random.truncated_normal instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:74: The name tf.get_default_graph is deprecated. Please use tf.compat.v1.get_default_graph instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:174: The name tf.get_default_session is deprecated. Please use tf.compat.v1.get_default_session instead.

WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/backend/tensorflow_backend.py:181: The name tf.ConfigProto is deprecated. Please use tf.compat.v1.ConfigProto instead.

2022-07-11 16:14:07.427489: I tensorflow/core/platform/cpu_feature_guard.cc:142] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 AVX512F FMA
2022-07-11 16:14:07.444749: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcuda.so.1
2022-07-11 16:14:07.919997: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d493dab9a0 executing computations on platform CUDA. Devices:
2022-07-11 16:14:07.920095: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): Graphics Device, Compute Capability 7.0
2022-07-11 16:14:07.924540: I tensorflow/core/platform/profile_utils/cpu_utils.cc:94] CPU Frequency: 2400000000 Hz
2022-07-11 16:14:07.928121: I tensorflow/compiler/xla/service/service.cc:168] XLA service 0x55d493eed0c0 executing computations on platform Host. Devices:
2022-07-11 16:14:07.928205: I tensorflow/compiler/xla/service/service.cc:175]   StreamExecutor device (0): <undefined>, <undefined>
2022-07-11 16:14:07.930143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1640] Found device 0 with properties:
name: Graphics Device major: 7 minor: 0 memoryClockRate(GHz): 1.597
pciBusID: 0000:3b:00.0
2022-07-11 16:14:07.930795: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2022-07-11 16:14:07.933093: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
2022-07-11 16:14:07.935564: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcufft.so.10.0
2022-07-11 16:14:07.936122: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcurand.so.10.0
2022-07-11 16:14:07.938852: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusolver.so.10.0
2022-07-11 16:14:07.941040: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcusparse.so.10.0
2022-07-11 16:14:07.947669: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudnn.so.7
2022-07-11 16:14:07.950631: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1763] Adding visible gpu devices: 0
2022-07-11 16:14:07.950775: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcudart.so.10.0
2022-07-11 16:14:07.953087: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1181] Device interconnect StreamExecutor with strength 1 edge matrix:
2022-07-11 16:14:07.953143: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1187]      0
2022-07-11 16:14:07.953189: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1200] 0:   N
2022-07-11 16:14:07.956517: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1326] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 30458 MB memory) -> physical GPU (device: 0, name: Graphics Device, pci bus id: 0000:3b:00.0, compute capability: 7.0)
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/keras/optimizers.py:790: The name tf.train.Optimizer is deprecated. Please use tf.compat.v1.train.Optimizer instead.

__________________________________________________________________________________________________
Layer (type)                    Output Shape         Param #     Connected to
==================================================================================================
Input-Token (InputLayer)        (None, None)         0
__________________________________________________________________________________________________
Input-Segment (InputLayer)      (None, None)         0
__________________________________________________________________________________________________
Embedding-Token (Embedding)     multiple             4238208     Input-Token[0][0]
                                                                 MLM-Norm[0][0]
__________________________________________________________________________________________________
Embedding-Segment (Embedding)   (None, None, 312)    624         Input-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Token-Segment (Add)   (None, None, 312)    0           Embedding-Token[0][0]
                                                                 Embedding-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Position (PositionEmb (None, None, 312)    159744      Embedding-Token-Segment[0][0]
__________________________________________________________________________________________________
Embedding-Norm (LayerNormalizat (None, None, 312)    624         Embedding-Position[0][0]
__________________________________________________________________________________________________
Attention-UniLM-Mask (Lambda)   (None, 1, None, None 0           Input-Segment[0][0]
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    390624      Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Embedding-Norm[0][0]
                                                                 Attention-UniLM-Mask[0][0]
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Attention-UniLM-Mask[0][0]
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Attention-UniLM-Mask[0][0]
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Attention-UniLM-Mask[0][0]
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    0           Embedding-Norm[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[0][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[1][0
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward-Norm[2][0
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-MultiHeadSelfAttent (None, None, 312)    624         Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward (FeedFo (None, None, 312)    780312      Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-MultiHeadSelfAttentio
__________________________________________________________________________________________________
Transformer-FeedForward-Add (Ad (None, None, 312)    0           Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[0][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[1][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[2][0]
                                                                 Transformer-MultiHeadSelfAttentio
                                                                 Transformer-FeedForward[3][0]
__________________________________________________________________________________________________
Transformer-FeedForward-Norm (L (None, None, 312)    624         Transformer-FeedForward-Add[0][0]
                                                                 Transformer-FeedForward-Add[1][0]
                                                                 Transformer-FeedForward-Add[2][0]
                                                                 Transformer-FeedForward-Add[3][0]
__________________________________________________________________________________________________
MLM-Dense (Dense)               (None, None, 312)    97656       Transformer-FeedForward-Norm[3][0
__________________________________________________________________________________________________
MLM-Norm (LayerNormalization)   (None, None, 312)    624         MLM-Dense[0][0]
__________________________________________________________________________________________________
MLM-Bias (ScaleOffset)          (None, None, 13584)  13584       Embedding-Token[1][0]
__________________________________________________________________________________________________
MLM-Activation (Activation)     (None, None, 13584)  0           MLM-Bias[0][0]
__________________________________________________________________________________________________
cross_entropy_1 (CrossEntropy)  (None, None, 13584)  0           Input-Token[0][0]
                                                                 Input-Segment[0][0]
                                                                 MLM-Activation[0][0]
==================================================================================================
Total params: 5,683,248
Trainable params: 5,683,248
Non-trainable params: 0
__________________________________________________________________________________________________
WARNING:tensorflow:From /home/bureaux/miniconda3/envs/Keras-base/lib/python3.6/site-packages/tensorflow/python/ops/math_grad.py:1250: add_dispatch_support.<locals>.wrapper (from tensorflow.python.ops.array_ops) is deprecated and will be removed in a future version.
Instructions for updating:
Use tf.where in 2.0, which has the same broadcast rule as np.where
Epoch 1/300
2022-07-11 16:14:50.711174: I tensorflow/stream_executor/platform/default/dso_loader.cc:42] Successfully opened dynamic library libcublas.so.10.0
24/24 [==============================] - 643s 27s/step - loss: 7.0690
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.08608825960188074, 'rouge-2': 0.002899153198913302, 'rouge-l': 0.08199449545448684, 'bleu': 0.004126396925857546, 'best_bleu': 0.004126396925857546}
Epoch 2/300
24/24 [==============================] - 338s 14s/step - loss: 5.7347
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.15696909447117124, 'rouge-2': 0.02950001457418542, 'rouge-l': 0.14894990972614477, 'bleu': 0.008160948241785386, 'best_bleu': 0.008160948241785386}
Epoch 3/300
24/24 [==============================] - 340s 14s/step - loss: 4.7116
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.1798172914014911, 'rouge-2': 0.048138259052273126, 'rouge-l': 0.16808600779891733, 'bleu': 0.009719917898951026, 'best_bleu': 0.009719917898951026}
Epoch 4/300
24/24 [==============================] - 338s 14s/step - loss: 3.6590
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.2440792167224316, 'rouge-2': 0.08054807890153554, 'rouge-l': 0.22718523066282284, 'bleu': 0.0155070863194135, 'best_bleu': 0.0155070863194135}
Epoch 5/300
24/24 [==============================] - 334s 14s/step - loss: 2.9980
100%|█████████████████████████████████████████| 500/500 [06:15<00:00,  1.33it/s]
valid_data: {'rouge-1': 0.3138020963839943, 'rouge-2': 0.13154435715636528, 'rouge-l': 0.2944663361255031, 'bleu': 0.03055774251493209, 'best_bleu': 0.03055774251493209}
Epoch 6/300
24/24 [==============================] - 340s 14s/step - loss: 2.6608
100%|█████████████████████████████████████████| 500/500 [06:11<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.36980418267289855, 'rouge-2': 0.18216292765260347, 'rouge-l': 0.3451342635809753, 'bleu': 0.05181399328831809, 'best_bleu': 0.05181399328831809}
Epoch 7/300
24/24 [==============================] - 337s 14s/step - loss: 2.4642
100%|█████████████████████████████████████████| 500/500 [06:11<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.4080357158280397, 'rouge-2': 0.22127667441214052, 'rouge-l': 0.3848593668174055, 'bleu': 0.07109621579289165, 'best_bleu': 0.07109621579289165}
Epoch 8/300
24/24 [==============================] - 337s 14s/step - loss: 2.3353
100%|█████████████████████████████████████████| 500/500 [05:59<00:00,  1.39it/s]
valid_data: {'rouge-1': 0.43583848477007, 'rouge-2': 0.2513648814746891, 'rouge-l': 0.4114768355643996, 'bleu': 0.0881748872891483, 'best_bleu': 0.0881748872891483}
Epoch 9/300
24/24 [==============================] - 337s 14s/step - loss: 2.2333
100%|█████████████████████████████████████████| 500/500 [06:06<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.4610740716117071, 'rouge-2': 0.2793487149709915, 'rouge-l': 0.43592309070494256, 'bleu': 0.10542076794612563, 'best_bleu': 0.10542076794612563}
Epoch 10/300
24/24 [==============================] - 338s 14s/step - loss: 2.1448
100%|█████████████████████████████████████████| 500/500 [06:11<00:00,  1.34it/s]
valid_data: {'rouge-1': 0.4823888524436351, 'rouge-2': 0.30223475422296053, 'rouge-l': 0.45656370514079997, 'bleu': 0.12035203545663312, 'best_bleu': 0.12035203545663312}
Epoch 11/300
24/24 [==============================] - 341s 14s/step - loss: 2.0637
100%|█████████████████████████████████████████| 500/500 [06:12<00:00,  1.34it/s]
valid_data: {'rouge-1': 0.4933123304289132, 'rouge-2': 0.3148568635094909, 'rouge-l': 0.46739380441901307, 'bleu': 0.12933261198230372, 'best_bleu': 0.12933261198230372}
Epoch 12/300
24/24 [==============================] - 340s 14s/step - loss: 1.9915
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5036497570583206, 'rouge-2': 0.32745735959581, 'rouge-l': 0.4761189679906571, 'bleu': 0.13869841344578343, 'best_bleu': 0.13869841344578343}
Epoch 13/300
24/24 [==============================] - 338s 14s/step - loss: 1.9259
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.5049111399789818, 'rouge-2': 0.330754669387075, 'rouge-l': 0.47410650693208967, 'bleu': 0.14487328507535388, 'best_bleu': 0.14487328507535388}
Epoch 14/300
24/24 [==============================] - 340s 14s/step - loss: 1.8661
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.5074055456957315, 'rouge-2': 0.33333614726927346, 'rouge-l': 0.475035259564514, 'bleu': 0.15015865810735046, 'best_bleu': 0.15015865810735046}
Epoch 15/300
24/24 [==============================] - 337s 14s/step - loss: 1.8049
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5090812087838048, 'rouge-2': 0.33579248131913275, 'rouge-l': 0.47550421104126617, 'bleu': 0.15315656296359603, 'best_bleu': 0.15315656296359603}
Epoch 16/300
24/24 [==============================] - 343s 14s/step - loss: 1.7504
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5105774879842928, 'rouge-2': 0.3403073044364323, 'rouge-l': 0.47751824516878355, 'bleu': 0.16056539215605453, 'best_bleu': 0.16056539215605453}
Epoch 17/300
24/24 [==============================] - 338s 14s/step - loss: 1.6997
100%|█████████████████████████████████████████| 500/500 [06:12<00:00,  1.34it/s]
valid_data: {'rouge-1': 0.5147816991762542, 'rouge-2': 0.3447265551330419, 'rouge-l': 0.4827143331458967, 'bleu': 0.1656974109629567, 'best_bleu': 0.1656974109629567}
Epoch 18/300
24/24 [==============================] - 336s 14s/step - loss: 1.6450
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5106619332409885, 'rouge-2': 0.3422529689196148, 'rouge-l': 0.4780377663079592, 'bleu': 0.16639207783665325, 'best_bleu': 0.16639207783665325}
Epoch 19/300
24/24 [==============================] - 339s 14s/step - loss: 1.5911
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5067456187073212, 'rouge-2': 0.3411920800166036, 'rouge-l': 0.4741569504788825, 'bleu': 0.1674260379663853, 'best_bleu': 0.1674260379663853}
Epoch 20/300
24/24 [==============================] - 333s 14s/step - loss: 1.5422
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5093499333425501, 'rouge-2': 0.34205943525291665, 'rouge-l': 0.4762814184190958, 'bleu': 0.16995807895471676, 'best_bleu': 0.16995807895471676}
Epoch 21/300
24/24 [==============================] - 343s 14s/step - loss: 1.5039
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
Early stop count 1/5
valid_data: {'rouge-1': 0.5046933765947679, 'rouge-2': 0.33801497853170664, 'rouge-l': 0.4704235878997457, 'bleu': 0.16940240977763715, 'best_bleu': 0.16995807895471676}
Epoch 22/300
24/24 [==============================] - 339s 14s/step - loss: 1.4706
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
Early stop count 2/5
valid_data: {'rouge-1': 0.49950903048273276, 'rouge-2': 0.33158659943870317, 'rouge-l': 0.46561564355744495, 'bleu': 0.16692478460925686, 'best_bleu': 0.16995807895471676}
Epoch 23/300
24/24 [==============================] - 339s 14s/step - loss: 1.4287
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
Early stop count 3/5
valid_data: {'rouge-1': 0.5015575844456036, 'rouge-2': 0.33467968057111563, 'rouge-l': 0.46821988942602916, 'bleu': 0.16971449793344454, 'best_bleu': 0.16995807895471676}
Epoch 24/300
24/24 [==============================] - 338s 14s/step - loss: 1.3884
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5047575214191541, 'rouge-2': 0.3378276702630225, 'rouge-l': 0.47063172988790397, 'bleu': 0.17254540332831303, 'best_bleu': 0.17254540332831303}
Epoch 25/300
24/24 [==============================] - 338s 14s/step - loss: 1.3433
100%|█████████████████████████████████████████| 500/500 [06:06<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.5045834574300414, 'rouge-2': 0.3383997377968676, 'rouge-l': 0.47012398012803375, 'bleu': 0.1737329954883615, 'best_bleu': 0.1737329954883615}
Epoch 26/300
24/24 [==============================] - 341s 14s/step - loss: 1.3032
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
Early stop count 1/5
valid_data: {'rouge-1': 0.502828285197155, 'rouge-2': 0.3376775034512965, 'rouge-l': 0.4691829749035249, 'bleu': 0.17276681333855495, 'best_bleu': 0.1737329954883615}
Epoch 27/300
24/24 [==============================] - 339s 14s/step - loss: 1.2650
100%|█████████████████████████████████████████| 500/500 [06:09<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5030624428607084, 'rouge-2': 0.33824910955692483, 'rouge-l': 0.46743970346557095, 'bleu': 0.17428064187593242, 'best_bleu': 0.17428064187593242}
Epoch 28/300
24/24 [==============================] - 339s 14s/step - loss: 1.2351
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
valid_data: {'rouge-1': 0.5065559464743882, 'rouge-2': 0.3410261148183699, 'rouge-l': 0.470273808170664, 'bleu': 0.1760641588986315, 'best_bleu': 0.1760641588986315}
Epoch 29/300
24/24 [==============================] - 339s 14s/step - loss: 1.2162
100%|█████████████████████████████████████████| 500/500 [06:10<00:00,  1.35it/s]
valid_data: {'rouge-1': 0.5058110831762043, 'rouge-2': 0.3409040201554133, 'rouge-l': 0.4699318273823744, 'bleu': 0.1773905454644884, 'best_bleu': 0.1773905454644884}
Epoch 30/300
24/24 [==============================] - 336s 14s/step - loss: 1.1817
100%|█████████████████████████████████████████| 500/500 [06:06<00:00,  1.37it/s]
Early stop count 1/5
valid_data: {'rouge-1': 0.5018120073078984, 'rouge-2': 0.337402185826842, 'rouge-l': 0.46632308396902805, 'bleu': 0.17520063907365596, 'best_bleu': 0.1773905454644884}
Epoch 31/300
24/24 [==============================] - 341s 14s/step - loss: 1.1469
100%|█████████████████████████████████████████| 500/500 [05:40<00:00,  1.47it/s]
Early stop count 2/5
valid_data: {'rouge-1': 0.5006702117136594, 'rouge-2': 0.3354170225851184, 'rouge-l': 0.46458813449929426, 'bleu': 0.1741872788470598, 'best_bleu': 0.1773905454644884}
Epoch 32/300
24/24 [==============================] - 337s 14s/step - loss: 1.1240
100%|█████████████████████████████████████████| 500/500 [06:07<00:00,  1.36it/s]
Early stop count 3/5
valid_data: {'rouge-1': 0.4982450712592889, 'rouge-2': 0.33337638478373843, 'rouge-l': 0.4630436395089345, 'bleu': 0.17245022749247627, 'best_bleu': 0.1773905454644884}
Epoch 33/300
24/24 [==============================] - 338s 14s/step - loss: 1.0964
100%|█████████████████████████████████████████| 500/500 [06:13<00:00,  1.34it/s]
Early stop count 4/5
valid_data: {'rouge-1': 0.4978484149126752, 'rouge-2': 0.3328488968982449, 'rouge-l': 0.4627477472946272, 'bleu': 0.17293319969983356, 'best_bleu': 0.1773905454644884}
Epoch 34/300
24/24 [==============================] - 338s 14s/step - loss: 1.0711
100%|█████████████████████████████████████████| 500/500 [06:08<00:00,  1.36it/s]
Early stop count 5/5
Epoch 00033: early stopping THR
valid_data: {'rouge-1': 0.4976155246714125, 'rouge-2': 0.3326760047497126, 'rouge-l': 0.46122863925717883, 'bleu': 0.1734215535438273, 'best_bleu': 0.1773905454644884}

进程已结束,退出代码0
